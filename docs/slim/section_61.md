---
title: Lesson 2.25 - Superglobals - Sessions & Cookies - Output Buffering
description: Slim notes.
order: 61
---

[00:00](https://www.youtube.com/watch?v=6vM-9ou1ARo&t=0s) - Intro about sessions & cookies

Sessions and cookies are mechanisms used in web development to store and manage data between multiple requests from the same user. They allow websites to maintain state and provide personalized experiences for users. Both sessions and cookies are important tools for implementing user authentication, tracking user interactions, and maintaining user-specific data.

**Cookies:**
- Cookies are small pieces of data that a web server sends to a user's browser and are stored on the user's device.
- Cookies can be set with an expiration date, after which they are automatically removed.
- They are commonly used for tracking user behavior, remembering user preferences, and maintaining session information.
- Cookies can be accessed and manipulated both on the client side (using JavaScript) and the server side (using PHP).
- However, cookies have limitations, such as size restrictions, security concerns, and users can disable or clear them.

**Sessions:**
- Sessions are a way to store user-specific data on the server side.
- A session is initiated when a user visits a website, and a unique session identifier (usually stored in a cookie) is assigned to the user.
- The server stores the session data associated with the session identifier.
- Session data can include user authentication status, shopping cart contents, and other user-specific information.
- Sessions are more secure than cookies because the actual data is stored on the server, and only a session identifier is sent to the client.
- PHP provides a built-in mechanism for managing sessions using the `$_SESSION` superglobal.

Here's a simple example of using sessions and cookies in PHP:

**Using Sessions:**
```php
session_start(); // Start or resume the session

// Storing data in the session
$_SESSION['username'] = 'john_doe';

// Retrieving data from the session
$username = $_SESSION['username'];

// Destroying the session
session_destroy();
```

**Using Cookies:**
```php
// Setting a cookie
setcookie('username', 'john_doe', time() + 3600, '/');

// Retrieving data from a cookie
$username = $_COOKIE['username'];

// Deleting a cookie
setcookie('username', '', time() - 3600, '/');
```

It's important to use cookies and sessions responsibly and consider security implications. Sensitive information should not be stored directly in cookies, and session data should be properly sanitized and validated. Additionally, consider using secure and HTTP-only flags for cookies to enhance security.

[00:36](https://www.youtube.com/watch?v=6vM-9ou1ARo&t=36s) - Starting sessions, output buffering & what happens when sessions are started after output

Starting sessions and using output buffering are common techniques in web development to manage data flow, ensure proper content delivery, and enhance user experience. However, there are certain considerations when it comes to the order of these operations, particularly with regard to starting sessions after output has been sent to the client.

**Starting Sessions:**
Starting a session in PHP is typically done using the `session_start()` function. It initializes or resumes a session and makes session-related data available through the `$_SESSION` superglobal.

**Output Buffering:**
Output buffering allows you to capture output generated by PHP scripts before sending it to the client's browser. This can be useful for manipulating content, preventing headers from being sent prematurely, and managing error messages.

**Order of Operations and Starting Sessions after Output:**
In PHP, it's recommended to start sessions before any output is sent to the client's browser. This is because starting a session requires sending a session cookie to the browser, and headers must be sent before any content is output.

If you try to start a session after some content has been sent to the client, PHP may encounter issues like the "headers already sent" warning. This is because headers, including cookies, must be sent before any actual content.

Here's a simplified explanation of what happens when you start sessions after output:

1. Your PHP script begins executing.
2. Some output is sent to the client's browser.
3. You attempt to start a session using `session_start()`.
4. PHP tries to send session-related headers (including cookies).
5. Since output has already begun, headers cannot be sent, and PHP throws a warning.

To avoid such issues, make sure to start sessions before any output is generated. You can use output buffering to capture output until you're ready to send it.

Example of Starting Sessions Properly:
```php
<?php
session_start(); // Start the session before any output

// Process your logic

echo "Some content"; // Output generated after session has started
?>
```

If you need to start sessions after output, consider using output buffering to capture and manipulate content before sending it to the client.

Example of Using Output Buffering to Start Sessions after Output:
```php
<?php
ob_start(); // Start output buffering

// Process your logic

session_start(); // Start the session after output buffering

// Now you can send the captured content
ob_end_flush();
?>
```

Remember to follow best practices to ensure smooth execution and avoid common pitfalls related to sessions and output buffering.

Output buffering is a feature in PHP that allows you to capture the output of your script before it's sent to the browser. This can be useful for various purposes, such as modifying the output, compressing it, or preventing unwanted output from being sent. To configure output buffering, you can use the `output_buffering` directive in the PHP configuration or the `ob_*` functions in your script.

Here's how you can configure output buffering:

**Using PHP Configuration (php.ini):**

1. Open your `php.ini` configuration file.
2. Search for the `output_buffering` directive.
3. Set the value of `output_buffering` based on your requirements. You can set it to:

   - `Off`: Output buffering is disabled.
   - `On`: Output buffering is enabled, and it will automatically determine the buffer size.
   - A specific buffer size (e.g., `4096`): Output buffering is enabled with the specified buffer size.

Example:
```ini
output_buffering = On
```

4. Save the `php.ini` file and restart your web server for the changes to take effect.

**Using PHP Functions:**

In addition to configuring output buffering in `php.ini`, you can also use PHP functions to control output buffering within your scripts.

1. **`ob_start()`:** This function starts output buffering. Any output generated after calling this function will be captured in the buffer.

   ```php
   <?php
   ob_start();
   echo "This will be captured in the buffer.";
   
   ```

2. **`ob_get_contents()`:** This function retrieves the contents of the output buffer without sending it to the browser.

   ```php
   <?php
   ob_start();
   echo "This will be captured in the buffer.";
   $contents = ob_get_contents();
   ob_end_clean(); // Clean and close the buffer
   echo "This will be sent to the browser.";
   
   ```

3. **`ob_end_flush()`:** This function sends the contents of the output buffer to the browser and ends output buffering.

   ```php
   <?php
   ob_start();
   echo "This will be captured in the buffer.";
   ob_end_flush(); // Send buffer contents and end buffering
   echo "This will be sent to the browser.";
   
   ```

By default, the `output_buffering` configuration directive is disabled in PHP CLI (Command Line Interface) mode. This means that output buffering is not active when running PHP scripts from the command line.

As a result, the browser will receive the entire output of the script after the cumulative `sleep` time has passed. This behavior aligns with the nature of web servers and browsers, which expect complete responses before rendering content.

Keep in mind that using `sleep` in this way can lead to poor user experience in a real web application, as users will have to wait for the combined sleep time before seeing any output. It's generally better to avoid using `sleep` for introducing delays in web applications and instead focus on asynchronous and non-blocking techniques when needed.


[06:09](https://www.youtube.com/watch?v=6vM-9ou1ARo&t=369s) - Storing, retrieving, and deleting sessions & $\_SESSION superglobal 

Storing, retrieving, and deleting sessions in PHP is facilitated through the `$_SESSION` superglobal. This superglobal allows you to store and access session data across different requests. Here's how you can work with sessions using the `$_SESSION` superglobal:

**Storing Session Data:**
To store data in a session, you can simply assign values to keys within the `$_SESSION` array.

```php
session_start(); // Start or resume the session

$_SESSION['username'] = 'john_doe';
$_SESSION['user_id'] = 123;
```

**Retrieving Session Data:**
You can access the session data later using the same keys.

```php
session_start(); // Start or resume the session

$username = $_SESSION['username'];
$user_id = $_SESSION['user_id'];

echo "Welcome, $username (User ID: $user_id)";
```

**Deleting Session Data:**
To delete specific session data, you can use the `unset()` function.

```php
session_start(); // Start or resume the session

unset($_SESSION['username']);
```

**Destroying a Session:**
To completely destroy a session and remove all session data, you can use the `session_destroy()` function.

```php
session_start(); // Start or resume the session

session_destroy();
```

Keep in mind the following points when working with sessions:

1. **Starting a Session:** Always start the session using `session_start()` before accessing or modifying session data.

2. **Session Persistence:** Session data is usually stored on the server side. PHP uses a session ID stored in a cookie or passed in the URL to identify the correct session data.

3. **Session Expiry:** Session data can be configured to expire after a certain period of inactivity. This is often controlled by PHP configuration settings.

4. **Security:** Be cautious about storing sensitive information in sessions. Avoid storing passwords or other sensitive data. Store only what's necessary for user interaction.

5. **Session Security:** Sessions can be vulnerable to attacks like session fixation and session hijacking. To enhance security, use techniques like session regeneration, using secure and HTTP-only flags for session cookies, and validating session data.

Remember to follow best practices for secure session management to ensure the privacy and integrity of user data.


[09:19](https://www.youtube.com/watch?v=6vM-9ou1ARo&t=559s) - Cookies & $_COOKIE superglobal

Cookies are small pieces of data that a web server sends to a user's browser. These cookies are stored locally on the user's device and can be used to store information that can be retrieved by the server on subsequent requests. Cookies are often used to maintain user sessions, store user preferences, and track user behavior on a website.

In PHP, cookies are managed using the `setcookie()` function to send a cookie to the user's browser and the `$_COOKIE` superglobal to retrieve cookie values in subsequent requests.

**Setting a Cookie:**
You can use the `setcookie()` function to send a cookie to the user's browser. The basic syntax is as follows:

```php
setcookie(name, value, expire, path, domain, secure, httponly);
```

- `name`: The name of the cookie.
- `value`: The value of the cookie.
- `expire`: The expiration time of the cookie (in seconds since the Unix epoch). Use `0` for a session cookie.
- `path`: The path on the server where the cookie is available.
- `domain`: The domain where the cookie is available.
- `secure`: Set to `true` to send the cookie only over HTTPS.
- `httponly`: Set to `true` to make the cookie accessible only via HTTP and not JavaScript.

**Example:**
```php
setcookie("user_id", 123, time() + 3600, "/", ".example.com", true, true);
```

**Retrieving Cookie Values:**
After a cookie has been set, you can retrieve its value using the `$_COOKIE` superglobal.

```php
$user_id = $_COOKIE["user_id"];
```

**Deleting a Cookie:**
To delete a cookie, you can set its expiration time to a past value using the `setcookie()` function.

```php
setcookie("user_id", "", time() - 3600, "/", ".example.com", true, true);
```

Remember that cookies are stored on the user's device and can be manipulated by the user. As a result, avoid storing sensitive information in cookies and use proper security measures to protect your application.

Cookies can be useful for various purposes, such as maintaining user sessions, remembering user preferences, and tracking user interactions. However, be mindful of privacy concerns and follow best practices for cookie usage.

To configure sessions and cookies in PHP through the configuration files (`php.ini`), you can adjust specific directives that control their behavior. Here's how you can do it:

1. **Session Configuration:**

   Sessions can be configured using the following `php.ini` directives:

   - `session.save_handler`: Specifies the handler used to store session data. Common values include `"files"`, `"memcached"`, `"redis"`, etc.
   - `session.save_path`: Specifies the directory where session files are stored when using the `"files"` save handler.
   - `session.gc_probability` and `session.gc_divisor`: Control the probability that the garbage collection process will run on session startup. Adjusting these values can impact the frequency of cleaning up expired sessions.
   - `session.cookie_lifetime`: Sets the lifetime of the session cookie in seconds.
   - `session.cookie_path`: Specifies the path on the server where the cookie will be available.
   - `session.cookie_domain`: Specifies the domain for which the cookie is available.
   - `session.cookie_secure`: If set to `true`, the cookie will only be sent over secure (HTTPS) connections.
   - `session.cookie_httponly`: If set to `true`, the cookie will be accessible only through the HTTP protocol.

2. **Cookie Configuration:**

   Cookies can be configured using `php.ini` directives as well as when using the `setcookie()` function in your PHP script:

   - `session.cookie_lifetime`, `session.cookie_path`, `session.cookie_domain`, `session.cookie_secure`, and `session.cookie_httponly`: Similar to session configuration, these settings can be adjusted to control cookie behavior.